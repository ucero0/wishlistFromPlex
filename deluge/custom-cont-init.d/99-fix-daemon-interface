#!/bin/bash
echo "[custom-init] Configuring deluged to listen on all interfaces..."
RUN_FILE="/etc/s6-overlay/s6-rc.d/svc-deluged/run"
if [ -f "$RUN_FILE" ]; then
    if ! grep -q "\-i 0.0.0.0" "$RUN_FILE"; then
        sed -i 's|/usr/bin/deluged|/usr/bin/deluged -i 0.0.0.0|g' "$RUN_FILE"
        echo "[custom-init] Modified deluged to bind to 0.0.0.0"
        cat "$RUN_FILE"
    else
        echo "[custom-init] deluged already configured for 0.0.0.0"
    fi
else
    echo "[custom-init] Warning: Run file not found at $RUN_FILE"
fi
